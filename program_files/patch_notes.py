"""
4. 구성
* 프로그램 구성
- 프로그램 코드에는 '4. 구성'의 모든 내용이 코드 최상단에 전체 내용 기입 + 관련 코드 항목에 각각 코멘트 기입 필요 : 최종 : 최상단에 구성 전체 내용 기입 + 각 항목별 코멘트 기입 (다른 ai 혹은 프로그래머가 코드만 보고 코드 작성 가이드를 따를 수 있어야 함)
- 사용자는 설치 파일만 실행, 나머지 설치 과정은 파이썬 코드가 자동으로 진행
- '설치 GUI', '실행 GUI' 로 구분
- 모든 과정은 GUI 를 적용하여 .pyw 로 cmd 창 없이 GUI로 진행
- '설치 GUI' 파일을 실행하면, [폴더 생성 -> 파일 생성 -> 필요 라이브러리 자동 다운로드 및 설치] 까지 원클릭 진행
- 설치가 완료 후, 설치된 '실행 GUI' 파일로 프로그램을 실행
- 소스 코드는 반드시 영어(English)로 작성하여 코드 호환성 유지
- GUI 출력(라벨, 버튼, 알림창)은 반드시 한국어(Korean)로 작성하여 사용자 편의성 극대화
- 역할, 파트 별로 파일을 나누어서 1개의 폴더 안에 저장

* '설치 GUI'
- 라이브러리가 설치되는 과정을 검은색 CMD 창이 아닌, '설치 GUI' 로딩 창(Progress Bar)으로 표현
- 모든 설치 과정은 항목 별로 총 작업량 대비 현재 작업량을 퍼센티지화 하여 진척률을 확인할 수 있는 시각적 이미지 적용
- 설치 진행률은 전체 항목과 현재 항목을 구분하여 Progress Bar 를 각각 적용
- 설치 폴더를 '설치 GUI' 안의 버튼을 이용하여 사용자가 지정
- 결과 파일은 지정 된 설치 폴더에 하위폴더 없이 저장

* 실행 GUI
- Indexing 이 진행되는 과정을 검은색 CMD 창이 아닌, '실행 GUI' 로딩 창(Progress Bar)으로 표현
- 작업 과정은 항목 별로 총 작업량 대비 현재 작업량을 퍼센티지화 하여 진척률을 확인할 수 있는 시각적 이미지 적용
- 작업 진행률은 전체 항목과 현재 항목을 구분하여 Progress Bar 를 각각 적용
- 원본 파일을 불러오는 폴더를 '실행 GUI' 상에서 사용자가 지정
- 프로그램을 제작하는 과정에서 누적된 패치 및 업데이트 사항에 대한 모든 내용을 누락없이 표시 (패치 및 업데이트 페이지는 버전별로 폴더형식으로 눌러서 열어볼 수 있또록 누락없이 모든 내용 기입,핵심 요약이 아니라 관련 내용이 자세하게 기입)
"""

# Patch and update records are stored version-by-version for folder-style display in the runtime GUI.
PATCH_NOTES = {
    "v1.1.6": {
        "date": "2026-02-15",
        "title": "index_config 파일 누락 오류 해결 + 사전 안정성 12개 보강",
        "details": [
            "index 존재 판정을 manifest 유무가 아닌 실제 index_config(.json/.json.gz) 파일 존재 여부 기반으로 변경했습니다.",
            "기존 인덱스 로딩 시 실제 인덱스 디렉터리 후보를 스캔해 올바른 index_path/index_root를 선택하도록 보강했습니다.",
            "index_config 누락(FileNotFound) 오류를 별도 분류해 손상 인덱스 원인을 명확히 안내하도록 수정했습니다.",
            "문서별 인덱싱 중 index exists / index_config 누락 발생 시 기존 인덱스를 재로딩한 뒤 즉시 재시도하도록 보강했습니다.",
            "이미 인덱싱된 문서는 index_manifest의 절대경로 기준으로 PASS 처리하여 중복 인덱싱을 방지했습니다.",
            "매니페스트 저장을 임시파일(tmp) 기록 후 원자적 replace 방식으로 바꿔 저장 중단 시 파일 손상을 줄였습니다.",
            "문서 수집 시 0바이트 파일을 자동 제외해 파싱 실패 가능성을 사전 차단했습니다.",
            "문서 목록 정렬/중복 제거를 적용해 실행 재현성과 로그 추적성을 높였습니다.",
            "인덱스 저장 폴더 쓰기 권한을 사전 점검해 권한 오류를 작업 초기에 즉시 감지하도록 추가했습니다.",
            "경로 문자열을 resolve 기반으로 정규화해 Windows 경로 표기 차이로 인한 매칭 실패를 방지했습니다.",
            "Byaldi API 시그니처 차이(index/add_to_index, index_root/index_path)를 모드별로 분리해 호환성을 강화했습니다.",
            "OOM/CUDA/이미 로딩된 인덱스 오류 메시지를 표준화해 운영자가 재조치 경로를 빠르게 파악하도록 개선했습니다."
        ],
    },
    "v1.1.5": {
        "date": "2026-02-15",
        "title": "중복 인덱싱 PASS + index exists 재발 방지 강화",
        "details": [
            "index_manifest.json의 indexed_documents를 기준으로 이미 인덱싱된 문서는 자동 PASS 처리하도록 구현했습니다.",
            "기존 인덱스 존재 시 from_index로 먼저 로딩한 뒤 append 모드로 처리해 'already exists / overwrite=True' 재발을 구조적으로 차단했습니다.",
            "문서별 인덱싱 실패 시 index exists 오류는 즉시 append 모드로 전환 재시도하고, OOM/CUDA 오류는 표준 메시지로 안내하도록 보강했습니다."
        ],
    },
    "v1.1.4": {
        "date": "2026-02-15",
        "title": "기존 인덱스 충돌 근본 원인 해결 (from_index 직접 로딩)",
        "details": [
            "'index already exists (overwrite=True 필요)' 오류의 원인을 기존 인덱스가 있는 상태에서 새 인덱스 생성 경로를 호출하는 구조로 규정하고, 기존 인덱스 감지 시 from_index 직접 로딩으로 분기하도록 수정했습니다.",
            "기존 인덱스 충돌이 런타임에 발생해도 즉시 append 모드로 전환해 같은 문서를 재처리하도록 재시도 경로를 추가했습니다.",
            "Byaldi 버전별 API 차이를 고려해 index/add_to_index 호출 시그니처 시도 순서를 정리하고, OOM/CUDA/인덱스 충돌 오류를 한국어 진단 메시지로 표준화했습니다."
        ],
    },
    "v1.1.3": {
        "date": "2026-02-15",
        "title": "인덱싱 로그 추가 + 기존 인덱스 add_to_index 자동 재시도 강화",
        "details": [
            "인덱싱 탭에 스크롤 가능한 로그 창과 로그 지우기 버튼을 추가하여 진행률과 함께 상세 작업 이력을 실시간으로 확인할 수 있게 개선했습니다.",
            "Byaldi에서 기존 인덱스 이름 충돌 시 발생하는 'already loaded / add_to_index' 오류를 자동 감지하고 add_to_index 모드로 재시도하도록 보강했습니다.",
            "GPU 메모리 부족, CUDA 미지원 Torch 등 반복 발생 오류를 한국어 진단 메시지로 표준화해 원인 파악과 재조치를 쉽게 만들었습니다."
        ],
    },
    "v1.1.2": {
        "date": "2026-02-15",
        "title": "GPU(CUDA) 강제 인덱싱 모드 적용",
        "details": [
            "사용자 요청에 맞춰 인덱싱 파이프라인을 GPU(CUDA) 전용으로 변경하여 CPU 폴백을 제거했습니다.",
            "CUDA 비가용 또는 CUDA 미지원 Torch 환경에서는 즉시 한국어 오류 메시지로 원인을 안내하도록 수정했습니다.",
            "설치 GUI에서 PyTorch 설치를 CUDA 휠(cu121) 전용 경로로 고정해 GPU 실행 일관성을 강화했습니다."
        ],
    },
    "v1.1.1": {
        "date": "2026-02-15",
        "title": "CUDA Torch 오류 대응 강화 (설치/인덱싱 CPU 폴백)",
        "details": [
            "설치 GUI에서 CUDA용 PyTorch(cu121)를 우선 설치하고 실패 시 CPU용 PyTorch로 자동 폴백하도록 변경했습니다.",
            "설치 진행 상태에 CUDA 실패 -> CPU 전환 단계를 명확히 표시해 사용자가 현재 설치 경로를 확인할 수 있도록 개선했습니다.",
            "인덱싱 파이프라인에서 GPU 가용성 검사 후 CUDA/CPU 로더를 분기하고, CUDA 빌드 오류 발생 시 한국어 안내 메시지를 반환하도록 보강했습니다.",
            "인덱싱 매니페스트에 실제 사용 장치(device_used)를 저장해 사후 진단과 운영 추적이 가능하도록 개선했습니다."
        ],
    },
    "v1.1.0": {
        "date": "2026-02-11",
        "title": "Local LLM 로딩/질의응답 탭 추가 + 인덱스 이름 출력 전환",
        "details": [
            "실행 GUI에 '로컬 LLM 질의응답' 탭을 신설하여 인덱싱 이후 즉시 질문/답변 워크플로우를 수행할 수 있도록 개선했습니다.",
            "Local LLM 백엔드를 Ollama와 LM Studio(OpenAI 호환 API) 중에서 선택할 수 있도록 구현했습니다.",
            "백엔드별 모델 목록 조회 기능을 추가해 사용자가 실행 가능한 모델을 GUI에서 직접 선택하도록 구성했습니다.",
            "모델 로딩(웜업) 버튼을 추가하여 실제 추론 API를 호출해 모델을 메모리에 올리는 과정을 GUI에서 수행하도록 반영했습니다.",
            "Byaldi 검색 결과를 컨텍스트로 구성한 뒤 Local LLM에게 전달하여 RAG 기반 질의응답이 가능하도록 파이프라인을 확장했습니다.",
            "인덱스 이름 항목을 입력칸에서 읽기 전용 출력칸으로 변경해 고정 값(colpali_byaldi_local_index) 정책을 명확히 적용했습니다.",
            "인덱싱 완료 시 index_manifest.json을 저장하도록 추가하여 QA 단계에서 인덱스/문서 메타데이터를 재사용할 수 있게 했습니다.",
            "동시 작업 충돌을 줄이기 위해 모델 조회/로딩/질의 실행 시 작업 중복 실행 제어와 상태 메시지 처리를 보강했습니다.",
        ],
    },
    "v1.0.0": {
        "date": "2026-02-11",
        "title": "초기 릴리스 - ColPali + Byaldi + Local AI 로컬 설치/실행 GUI",
        "details": [
            "설치 GUI(.pyw)를 추가하여 사용자가 설치 폴더를 직접 선택하고, 버튼 한 번으로 파일 배치와 라이브러리 설치를 수행하도록 구성했습니다.",
            "설치 단계는 전체 진행률과 현재 항목 진행률을 분리한 2중 Progress Bar로 시각화했습니다.",
            "실행 GUI(.pyw)를 추가하여 원본 문서 폴더를 선택하고, 인덱싱 파이프라인을 GUI에서 실행하도록 구성했습니다.",
            "RAG 파이프라인은 무료 오픈소스 조합(ColPali + Byaldi + Qdrant Local + Ollama)을 기준으로 설계했습니다.",
            "문서 집합 전처리(지원 확장자 필터링, 메타데이터 수집) 단계를 별도 분리해 대용량 인덱싱 시 안정성을 높였습니다.",
            "인덱싱 무한 시간 투자 조건을 반영해 품질 우선 설정(고품질 모델, 세밀한 배치 처리, 로컬 벡터 저장)을 기본값으로 채택했습니다.",
            "패치/업데이트 페이지에서 버전 폴더를 펼쳐 각 변경사항을 상세 문장 단위로 확인할 수 있도록 구현했습니다.",
            "GUI 문구(라벨/버튼/안내/오류)는 한국어로 통일하고, 소스코드는 영어로 작성해 유지보수성과 사용성을 동시에 맞췄습니다.",
        ],
    },
}
